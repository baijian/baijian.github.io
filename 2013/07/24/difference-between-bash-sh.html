<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Deep-understand-Bash</title>
        <meta name="viewport" content="width=device-width">

        <!-- syntax highlighting CSS -->
        <link rel="stylesheet" href="/css/syntax.css">

        <!-- Custom CSS -->
        <link rel="stylesheet" href="/css/main.css">

    </head>
    <body>

        <div class="site">
          <div class="header">
            <h1 class="title"><a href="/">Too young too simple and too naive</a></h1>
            <a class="extra" href="/">home</a>
          </div>

          <h2>Deep-understand-Bash</h2>
<p class="meta">24 Jul 2013</p>

<div class="post">
<h2>一. Bash and sh</h2>

<h3>Basic concepts</h3>

<p>Bash is Bourne again shell, <code>ls -l /bin/bash</code>,then <code>ls -l /bin/sh</code>,
then you will find, <code>/bin/sh -&gt; bash</code>, <code>sh</code> equals to <code>bash --posix</code>,
now in Ubuntu System you will find <code>/bin/sh -&gt; dash</code>, <code>dash</code> is different
with <code>bash</code>, it&#39;s for script executing, not for interaction, it&#39;s fast but
less functions than <code>bash</code>, and it comply with POSIX.</p>

<h3>Specify an interpreter for script</h3>

<p>You write a script, you may write <code>#!/bin/bash</code> in first line,
the you run <code>chmod +x script</code>, then run it, it will use bash 
interpreter to run it, or write <code>/bin/bash script</code> to specify a 
interpreter and <code>#!/bin/bash</code> will be no use.</p>

<h3>Differences</h3>

<p>要理解Bash和sh乃至Dash的区别,关键是要理解
Bash的POSIX Mode,POSIX是UNIX的一种标准,围绕着这个标准才有了今天UNIX开源事业
的潮气蓬勃,详细见这里<a href="http://en.wikipedia.org/wiki/POSIX">POSIX</a></p>

<h2>二.Type of shell</h2>

<h3>Interactive Shell</h3>

<p><code>echo $-</code>,如果含有i,就是interactive shell,interactive shell都含有<code>PS1</code>
变量,所以也可以通过是否存在<code>PS1</code>这个变量来判断是否微interactive shell.</p>

<h3>Non-Interactive Shell</h3>

<p>即与上面的解释向反,不含有i这个参数选项</p>

<h3>Login</h3>

<p>远程登录或者tty1-6登录的shell都是Logoin Shell.</p>

<h3>Non-Login</h3>

<p>像模拟终端的shell就是Non-Login Shell,比如terminal终端.</p>

<h2>三.Startup files of different type of shell</h2>

<h3>1.登录的shell</h3>

<p><em>Bash</em></p>

<p>当你登录一个交互的shell或者shell脚本执行时加上--login选项,也就是说是一个<code>login shell</code>,
配置读取<code>/etc/profile</code>这个配置文件,然后按下面的顺序再寻找配置文件</p>

<ul>
<li><p>1.~/.bash_profile</p></li>
<li><p>2.~/.bash_login</p></li>
<li><p>3.~/.profile</p></li>
</ul>

<p>寻找到第一个存在且可读的配置就不继续后面的寻找了.
其实可以看一下<code>/etc/profile</code>的内容,很有可能这个文件调用了<code>/etc/bash.bashrc</code>这个配置文件,
或者也调用了<code>/etc/profile.d/</code>下面的所有配置文件,再看看<code>~/.bash_profile</code>这个
文件,很有可能里面又调用了<code>~/.bashrc</code>这个配置文件.这些需要清晰一点，不然很容易混淆.</p>

<p><em>sh</em></p>

<p>首先读取并执行<code>/etc/profile</code>和<code>~/.profile</code></p>

<h3>2.交互的非登录shell</h3>

<p><em>Bash</em> </p>

<p>比如你在你的ubuntu系统里用terminal打开的终端shell就是交互的非登录shell,这种shell
会从<code>~/.bashrc</code>读取信息执行.</p>

<p><em>sh</em></p>

<p>寻找ENV环境变量的值命名的文件,读取并执行.</p>

<h3>3.非交互的非登录shell</h3>

<p><em>Bash</em></p>

<p>也就是你常用的shell脚本,它会把环境变量<code>BASH_ENV</code>的值当作文件名,如果文件存在且可读就进行读取执行.</p>

<p><em>sh</em></p>

<p>不会读取任何startup文件.</p>

<h3>End</h3>

<p>At last Recommend a web address: <a href="http://www.gnu.org/software/bash/manual/bashref.html">About Bash</a></p>

</div>


<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
var disqus_shortname = 'baijian'; // required: replace example with your forum shortname

/* * * DON'T EDIT BELOW THIS LINE * * */
(function() {
 var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
 dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
 (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
 })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>




          

    </body>
</html>
